<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>HeatCalc - Home Heating Assessment</title>
<link rel="stylesheet" href="./styles.css">
<!-- Three.js Library -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
</head>
<body>

<!-- App Container -->
<div id="app"></div>

<!-- Main Application Script -->
<script type="module">
import { initRouter, registerScreen, navigateTo } from './router.js';
import { InputScreen } from './InputScreen.js';
import { LoadingScreen } from './LoadingScreen.js';
import { ResultsScreen } from './ResultsScreen.js';
import { EditScreen } from './EditScreen.js';
import { enableAutoSave } from './state.js';
import { Building } from './Building.js';
import { PROPERTY_TEMPLATES } from './propertyTemplates.js';

import { SpaceEditor } from './SpaceEditor.js';

// Make Building and templates available globally for state management and 3D viewer
window.Building = Building;
window.PROPERTY_TEMPLATES = PROPERTY_TEMPLATES;

console.log('ðŸ  HeatCalc App Starting...');

// Initialize router
initRouter({
  container: document.getElementById('app'),
  defaultScreen: 'input',
  onNavigate: (screenName, data) => {
    console.log(`ðŸ“ Navigation: â†’ ${screenName}`);
  }
});

// Create screen instances
const inputScreen = new InputScreen();
const loadingScreen = new LoadingScreen();
const resultsScreen = new ResultsScreen();
const editScreen = new EditScreen();
const spaceEditor = new SpaceEditor();


// Register screens
registerScreen('input', inputScreen);
registerScreen('loading', loadingScreen);
registerScreen('results', resultsScreen);
registerScreen('edit', editScreen);
registerScreen('spaceEditor', spaceEditor);


// Enable auto-save (every 30 seconds)
enableAutoSave(30000);

// Start app
navigateTo('input');

console.log('âœ… HeatCalc App Ready');
console.log('ðŸ’¾ Auto-save enabled (every 30s)');
console.log('ðŸ”§ Debug tools: window.__debugRouter(), window.__debugState()');

// Expose navigation for debugging
window.__nav = {
  toInput: () => navigateTo('input'),
  toLoading: () => navigateTo('loading', { message: 'Testing...', nextScreen: 'input' }),
  toResults: () => navigateTo('results'),
  toEdit: () => navigateTo('edit')
};

console.log('ðŸŽ® Quick nav: window.__nav.toInput(), window.__nav.toResults(), window.__nav.toEdit()');
</script>

</body>
</html>
